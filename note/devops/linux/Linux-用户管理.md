# 用户和组管理

Linux中的用户和身份标识UID以及组标识 GID的概念就如同企业里头员工和其工号以及部门代号之间的关系。每一个员工都有自己唯一的工号，而每一个员工也会属于对应一个代号的部门下面。
| 系统  | 名字   | 唯一标识 | 组织标识 | 工作地方 |
| ----- | ------ | -------- | -------- | -------- |
| 企业  | 员工名 | 身份证   | 部门代号 | 工位     |
| Linux | 用户名 | UID      | GID      | 家目录   |
：

## 用户管理

### 用户分类

Linux当中基本可以分成三类用户

1. 超级用户
拥有着系统最高权限。相当于企业中的老板，拥有着整个企业的最高执行权限。

| 系统  | 名字 | 唯一标识 | 组织标识 | 工作地方   |
| ----- | ---- | -------- | -------- | ---------- |
| 企业  | boss | 430xxxx  | 0xx      | 老板办公室 |
| Linux | root | 0        | 0        | /root      |

2. 普通用户
登录的shell是`/bin/bash`
拥有着系统普通权限。可以写的范围在自己的家目录下。相当于企业中的员工，可以任意活动的地方就是在自己的工位上。
centos7中，表示在10000-60000

| 系统  | 名字 | 唯一标识 | 组织标识 | 工作地方  |
| ----- | ---- | -------- | -------- | --------- |
| 企业  | bob  | 460xxxx  | 1xx      | bob的工位 |
| Linux | bob  | 10000    | 10000    | /home/bob |

普通用户如何管理系统呢？有两种方式：
方式一：你让老板帮你做一些超出你权限范围的事情。linux中，su root切换成root角色，让root来做权限高的事情。
方式二：你让老板授权给你做一些超出你权限范围的事情。linux中，sudo获取root用户权限，去做root能做的事。

3. 虚拟用户
登录的shell是`/sbin/nologin`
这一类用户多数情况是在装系统的时候就存在的,不能登录。
既然没法登录，那么这种虚拟用户的意义在哪里呢？
我们知道，在linux当中，万物皆文件。文件创建时就应该要有对应的用户和组。像linux进程这些东西也是文件，那么就应该由某一个用户所拥有和被某个组所拥有。因此这种虚拟用户的意义就在于满足进程启动时对用户和组的要求。用普通用户虽然也能达到一个效果，但是别忘了普通用户事可以登录的，可以登录在某种程度上对系统就有安全隐患。而进程的启动不需要用户能够登录，只是要知道对应的满足用户就够了，权限最小化原则，能不登录当然就不登录。

### 用户相关的文件

#### 直接相关的配置文件

- `/etc/passwd` 用户主配置文件，存放用户的各种属性（啥事用户属性？也就是用户GID，用户的UID，用户的登录shell在哪里，用户的家目录在哪里都在这里记录着）
- `/etc/shadow` 用户密码文件，存放用户密码和密码的属性（啥是密码属性？也就是密码啥时候到期，密码啥时候更改的这些玩意）
- `/etc/group` 组文件，存放组的各种属性
- `/etc/gshadow` 组的密码文件【已经废弃】

#### 创建用户相关的配置文件

- `/etc/default/useradd` 创建用户命令useradd的配置文件
- `/etc/skel` 存放着创建用户环境变量原始文件的存放地方（就是用来配置.隐藏文件存放的地方）
- `/etc/login.defs`存放着创建用户系统配置相关的文件

#### 用户相关的命令

- `useradd`添加用户

  ```shell
  # 下面的命令只展示工作常用的添加方式 

  useradd test # 默认添加
  useradd test -g fe # 指定用户组的方式添加用户 - 添加用户属于fe组
  useradd test -e '2022/01/17' # 指定用户失效日期的方式添加用户 - vip会员场景
  useradd test -s /sbin/nologin -M  # 指定用户无家目录的方式添加用户 - 虚拟用户场景
  ```

- `id 用户名`查看指定uid用户部分信息
- `tail -n 1 /etc/passwd /etc/group /etc/shadow` 查看刚添加的用户【用完useradd之后立马使用就会展示刚创建用户的信息】
- `usermod`修改用户

    ```shell
  # 下面的命令只展示工作常用的添加方式 

  usermod test -g fe # 修改用户属于fe组
  usermod test -e '2022/01/17' # 修改用户失效日期 - vip场景
  ```

- `userdel`删除用户

   ```shell
  # 下面的命令只展示工作常用的添加方式 
  
  userdel test  # 只删除用户不删除家目录
  usermod test -r  # 删除用户的同时删除它的家目录 - 人员离职场景
  # 生产中，一个人员离职了，最好的相关处理方式是，直接编辑/etc/passwd把他的密码注释掉
  ```

## 组管理

用户的组类似于人的家庭/学校/企业等组
1个用户可以在多个组里头。反过来说，1个组也是可以有多个用户的。
用户组是如何产生的呢？

1. 用户组会在创建用户的时候，默认情况下就会生成一个跟用户名一样名字的组。而且组的标识GID和用户的标识UID也是相同的。
2. 由root用户直接取创建。
