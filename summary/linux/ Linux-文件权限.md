<div align="center">
  <img 
  src="https://raw.githubusercontent.com/workcjl/image_store/main/img/linux-file-permission.png" alt="Linux-File-Permission"/>
  <h1 align="center">
  Linux文件权限
  </h1>
</div>

改变文件属性和权限我们可以使用`chmod`,	`chown`，`chgrp`三个命令来做到。其中`chmod`用来修改文件的权限，具体来说就是修改文件使用者和使用组和其他人能够使用文件的哪些功能（文件的功能有三个：读文件、写文件、执行文件)。`chown`用来修改文件的所属人，具体来说就是修改这个文件属于谁，是谁的。`chgrp`用来修改文件的所属组，具体来说就是修改这个文件可以被哪一个小组单独进行使用的。

为了方便记忆，我们可以结合一个文件的属性结构去简化命令的记忆，一个文件的基本属性结构如下：

`-rw-rw---- 1 root root 0 9月  17 13:38 a.txt`，其中`-rw-rw----`三种不同类别的权限（每种又都有rwx三个具体权限）就是`chmod`作用的地方，`root`用户就是`chown`作用的地方，`root`组就是`chgrp`作用的地方。因此我们可以按照如下的方式记忆：

`chmod chown:chgrp 文件`

## 文件和文件夹的权限意义

---

对于文件和文件夹都有三种功能`r`、`w`、`x`。但是三种功能翻译过来的意思是不一样的。

### 文件的权限意义

对于**文件**来说，三种功能作用的对象是**文件里头的内容**。什么是文件里头的内容？对于一个`a.txt`文本文件来说，它里头的内容就是文本；对于一个`b.sh`脚本文件来说，它里头的内容就是脚本。而我们的`r`、`w`、`x`的目标就是文件的内容。

举例子来说，有一个叫做`a.txt`的文本文件，`r`就是我可以读取`a.txt`里头的文本；`w`就是我可以修改`a.txt`里头的内容；`x`就是假如这个文件是可以执行的，那么我就可以执行这个文件。

因此，要明白权限对于文件的意义是能否操作文件的内容。所以说`r`、`w`、`x`没有一个功能是指定文件本身的，也因此你没法从文件的`r`、`w`、`x`来决定一个文件是否可以被删除、可以被移动，因为这些操作都是作用在文件自己身上的！

### 文件夹的权限意义

对于**文件夹**来说，三种功能的作用的对象是**文件夹自己+文件夹里头的（文件或者子文件夹）**。

举例子来说，有一个叫做`b`的文件夹，`r`就是我可以读取`b`这个文件夹里头的结构，就是目录结构（`ls b`）；`w`代表的是我可以操作这个文件夹里头的文件或者子文件夹（`rm b/a.txt`或者`mv b/a.txt b/tmp`）；`x`代表的就是我可以进去这个文件夹里头(`cd b`)。

很多人想不明白文件夹`r`和`x`的关系，其实你可以这么想象一个具有`r`而没有`x`功能的文件夹，想象成上锁的（没有`x`）一个透明（具有`r`）文件夹，这样子因为文件夹是透明的（具有`r`）你就可以查看到里头的结构，但是这个文件夹是上锁的（没有`x`），所以你没法打开文件夹进去查看具体的文件。

当然如果一个文件夹只有`x`没有`r`的话，其实你可以想象成你打开一个没上锁的（有`x`）的文件夹，但是里头的文件结构你没权利看。就好像你有打开门的钥匙，但是你是眼睛蒙着一块布进去这扇门的。

## 实例

---

1.当你复制一个文件给你自己以外的其他人的时候，由于复制一个文件，会连文件的所有属性一块复制，导致的结果是：这个文件确实是多了一份，但是文件的属性并没有更改，具体来说就是文件的属于谁，属于哪个组，并没有更改。同时你还可能想要对所属人的权限，所属组的权限进一步进行更换。因此碰到这种场景，你可以使用`chmod`、`chown`、`chgrp`去更改文件的属性来满足你的需求。

- 我们首先用root账号在root文件夹当中创建一个`root.txt`，同时cp拷贝一份文件，并重名为`ma.txt`。

  ```shell
  [root@k8smaster root]# touch root.txt
  [root@k8smaster root]# cp root.txt ma.txt
  [root@k8smaster root]# ll
  总用量 0
  -rw-r--r-- 1 root root 0 9月  17 17:58 ma.txt
  -rw-r--r-- 1 root root 0 9月  17 17:58 root.txt
  ```

- 当我们使用`ll`查看整个root目录的内容时，发现我们确实多出了一份文件叫做`ma.txt`，但是我们发现拷贝过后的文件属性内容是跟`root.txt`完全一样的。此时你的想法是将这份文件给马云来用，如果经过你这样去拷贝过后，由于文件的属性此时跟之前的`root.txt`完全是一样的，所以这份文件`ma.txt`是会把马云看成陌生人（其他人），他的权限只有`r`，即功能只能是读文件。而我们的需求是希望这份文件送给了马云，文件属于马云，同时文件也属于马云的组。这样一来马云可以拥有读文件的功能，还可以有写文件的功能，这才是我们想要实现的效果。

- 于是为了完成这样的一个需求，我们可以利用`chmod`、`chown`、`chgrp`三剑客来完成我们想要的功能。我们使用`chown`完成文件转让，将该文件赠送给马云，彻底属于马云：

  ```shell
  [root@k8smaster root]# chown ma ma.txt
  [root@k8smaster root]# ll
  总用量 0
  -rw-r--r-- 1 ma   root 0 9月  17 17:58 ma.txt
  -rw-r--r-- 1 root root 0 9月  17 17:58 root.txt
  ```

- 接着我们使用`chgrp`完成文件所属小组的转让，让马云的小组成为该文件的所属组

  ```shell
  [root@k8smaster root]# chgrp ma ma.txt
  [root@k8smaster root]# ll
  总用量 0
  -rw-r--r-- 1 ma   ma   0 9月  17 17:58 ma.txt
  -rw-r--r-- 1 root root 0 9月  17 17:58 root.txt
  ```

- 经过我们的上述操作，这样子一份文件就彻底转让，属于马云和马云的组了。当马云收到这份赠送的文件之后，他有可能想要对文件进行权限的更改，比如说马云想只有他自己一个人可以看，马云的小组和其他人都不可以看到自己的文件（假设马云的组ma也有别人）,那么马云可以这么做（此时是马云ma在操作，不是root用户了，要分清楚）:

  **方式一**

  ```shell
  [ma@k8smaster ~]$ chmod 600 ma.txt
  [ma@k8smaster ~]$ ll
  总用量 0
  -rw------- 1 ma ma 0 9月  17 17:58 ma.txt
  ```

  当然马云也可以使用字符方式去更改权限

  **方式二**

  ```shell
  [ma@k8smaster ~]$ chmod u=rw ma.txt
  [ma@k8smaster ~]$ ll
  总用量 0
  -rw------- 1 ma ma 0 9月  17 17:58 ma.txt
  ```

  这样一来，马云就将文件设置成了只有自己可以查看，自己可以编辑，其他所有人包括自己小组的人都不能动这个文件了，达到了隐私保护的作用。

