# 软件包管理

软件包可以分类为源码包（将源代码直接开放给你的包，绝大多数就是c语言写的。缺点是安装慢，容易出错。源码包还有一种子类型，叫做脚本安装包。即不需要手动一步步安装的那种源码安装包，用脚本的执行去替代【类似Windows中窗口安装界面】但是这种源码包不多，需要人专门去些类似的脚本来安装。）和二进制包（二进制包就是经过编译之后的包，即源码包经过编译之后的0101二进制组成的机器语言包。在windows当中编译出来的是exe格式的包，而在linux当中对应的就是RPM格式的包。这种包的优点是安装比较快【毕竟不需要编译过程，粗略估计如果是mysql用源码安装要20分钟左右，但是用编译包只需要几分钟】；缺点是这种包没法看到源代码了。在centos当中二进制包被叫做RPM包，同时二进制包也可以叫做系统默认包）

## 源码包

### 源码包的优缺点

源码包的优点就是：

1. 开源，如果有动手能力就可以修改源代码

2. 可以自由选择自己需要的功能

3. 源码包安装的软件是编译安装，可以适配自己的计算机系统

4. 源码包卸载方便（直接删除掉源码包的目录就好，删除的干净！）

源码包的缺点就是：

1. 安装步骤较多。特别是那种大型的软件，容易出现拼写错误

2. 编译过程较长，安装比二进制包安装的时间要长

3. 因为是编译安装，安装的过程当中如果出错了比较难解决

### 源码包安装位置

一般是`/usr/local/软件名/`。举例：`usr/local/mysql`
RPM包安装的服务，可以使用系统服务管理命令`service`管理。比如：`service nginx start` service能找得到nginx服务，其实是去系统默认的安装目录当中寻找nginx相关的启动命令将nginx拿出来执行。因此service没发安装源码包安装的软件，因为安装的位置都不同。而源码包安装的服务只能用绝对路径的方式启动。

## 二进制包

### 二进制包的优缺点

二进制包的优点就是：

1. 包管理系统简单。通过简单的命令就可进行“安装”、“升级”、“查询”、“卸载”
  
2. 安装速度比源码包安装快很多

二进制包的缺点就是：

1. 无法重新看到源代码。因为是编译过后的

2. 无法自由定制功能。源码包洽洽相反

3. 依赖性强，安装A需要先安装B，安装B需要先安装C

### 二进制包的管理

#### rpm命令管理

在centos当中，二进制包就是rpm包。

- **rpm包的命名规则**是：软件包名+软件包版本+软件包发布的次数+适合的Linux平台+适合的硬件平台+rpm包扩展名（.rpm）
例子：httpd-2.2.15-15.el6.centos.1.i686.rpm
解读：httpd（软件包名）-2.2.15（软件包版本）-15（软件包发布的次数）.el6.centos（适合的Linux平台）.1.i686（适合的硬件平台）.rpm（rpm包扩展名）
要注意，在linux当中是没有扩展名区分的概念的，这是为了给管理员方便管理加上的。“httpd-2.2.15-15.el6.centos.1.i686.rpm”是包全名，“httpd”包名要区分开，因为有些安装必须是用包全名。

- 包全名和包名的使用途径（只对rpm命令才有这两个概念）
  如果我们操作的包是一个从来没有在系统中安装的软件包，那么就需要使用包全名，同时也要注意文件的路径
  如果我们操作的包是一个已经安装在系统中的软件包，它已经被系统识别了，所以直接使用包名就可以了。搜索的地方就是`/var/lib/rpm`中的数据库
- 使用rpm进行RPM包的安装
  `rpm -i（安装）v（显示详细安装信息）h（显示安装进度） 包全名`

- 使用rpm进行RPM包的升级
  `rpm -u（升级）v（显示详细安装信息）h（显示安装进度） 包全名`

- 使用rpm进行RPM包的卸载
  `rpm -e（卸载） 包全名`

- 使用rpm进行RPM包的查询
  `rpm -q（查询）a（所有的） 包名`
  RPM包的查询只能用`rpm`，无法使用`yum`

- 使用rpm进行RPM包的校验
  `rpm -V 已安装的包名`用这条命令可以查询出对这个软件包下的文件是否做了修改。用在安全方面。比如nginx.conf是nginx下的文件，如果就会被查出。

#### yum在线管理

- 配置网络yum源
  centos当中的yum源配置是放在`/etc/yum.repos.d/CentoOS-Base.repo`中。

- 使用yum查询指定的yum源服务器中所有可以安装的软件包
  `yum list`

- 使用yum搜索服务器中所有跟指定关键词相关的包
  `yum search 关键词`

- 使用yum安装软件包
  `yum install -y(自动回答yes，因为不加会询问) 软件包名`

- 使用yum升级软加包
  `yum update -y 软件包名`

- 使用yum卸载软件包
  `yum remove -y 软件包名`
  linux操作软件包的原则遵照“最小化原则”，需要啥安装啥，尽量不要卸载。yum卸载很智能，会把所有依赖包卸载，可能导致系统崩溃。卸载一个包，把相关联的全部卸载了，导致可能引起不知道的系统错误。

### 二进制包的安装位置

| 默认安装路径      | 相关安装文件               |
| ----------------- | -------------------------- |
| `/etc/`           | 配置文件安装位置           |
| `/usr/bin/`       | 可执行命令安装位置         |
| `/usr/lib`        | 程序所使用的函数库保存位置 |
| `/usr/share/doc/` | 基本的软件使用手册保存位置 |
| `/usr/man/`       | 帮助文件保存位置           |
