# Bash变量

## 本地变量

本地变量又可以叫做用户自定义变量。因为这些变量的名称都是用户自己定义生成的。它的作用范围是只在当前的shell当中生效。通俗地来说，就是你在哪个终端当中自己定义的变量就只能在这个终端内使用

## 环境变量

环境变量有一部分的名称是固定的，作用也是固定的。它的作用范围是在当前的shell以及zishell当中都能生效。进一步地，如果我们把环境变量写到配置文件当中，那么这个环境变量就可以在所有的shell当中生效。（包括新建shell，当前shell及当前shell的所有子shell）

### 声明一个环境变量

`export env=1`表示声明一个环境变量`env`，这个变量的值是1。声明一个环境变量的语法格式是`export var=val`。

### 查询环境变量

`env`可以查询环境变量。和`set`不同的是，`set`查看的是所有的变量，而`env`只查看环境变量。

### 调用环境变量

`$var`就可以调用变量var，语法格式是`$变量名`。

### 删除环境变量

`unset var`就可以删除环境变量var，语法格式是`unset  变量名`

## 预定义变量

### 位置参数变量

1. `$n` n表示一个数字。其中特殊的`$0`表示程序本身，比如说你写了./install.sh这个脚本，那么`$0`就表示`./install.sh`，而`$1`...`$x`就表示传递给这个程序的参数。比如说`./install.sh a b c`，那么`$1`就是`a`,`$2`就是`b`，`$3`就是`c`。

2. `$*` 表示传递给程序的所有参数的整体。效果上就像传递给程序就只有一个变量一样，不过这个变量的输出时参数整体。比如说./install.sh a b c 那么`$*`的值就是`a b c`这个整体。如果你去for循环这个整体，只会循环1次。（很像`JSON.stringify([a,b,c])`就是把参数整体成一个字符串） 

3. `$@` 也表示传递给程序的所有参数。效果上就是相当于`JS`当中的`...args`。比如说./install.sh a b c,那么`$@` 就是`[a,b,c]` 。如果你去for循环，会循环3次。因为实际上就是在循环这个数组`[a,b,c]`。

4. `$#` 表示传递给程序的参数个数。效果上就是相当于JS当中一个函数fn(a,b,c)中的a,b,c的个数3。

### 其他预定义变量

1. `$?`  表示上一条命令的执行结果代码。如果上一条命令执行成功了，`$?`这个变量装的就是0，如果上一条命令是一条不存在的命令，执行后，输出`$?`这个变量的值就是127。总之，`$?`就是上一条命令的执行成功与否的表示。这个变量的实际作用在于让程序自身去判断一条命令是否执行成功了，在写脚本的时候程序执行时产生作用，我们不能用上帝视角去看待，因为比如`ls -d /project`这条命令，人为可以在屏幕上看到知道是否出错，但是如果写到程序里头，程序在执行当中没法看到屏幕的结果，也就不知道错误与否，所以需要借助`$?`来帮助程序知道一条命令的执行正确与否，从而进行下一步的操作。

2. `$$` 表示当前进程的进程号PID。计算机通过这个 PID来判断当前运行的进程是哪一个。

3. `$!` 表示后台运行的最后一个进程的进程号PID。

## read命令

使用read命令就可以交互式的告诉用户需要往程序里传递要指定的变量。而不再需要使用`$n`猜谜语的方式去往程序里传递变量了。
`read -p 这里写上想要在屏幕上输出的信息 age`可以将想要高速用户的信息输出到屏幕上等待执行，用户输入的记过会传递给`age`变量。

`read -t 30 -p "您好，输入1个数" num`带上`-t 30`后，程序就不会无限等待用户的输入，30s后就会自动终止程序。`-t 秒数`指定程序会等待用户多少秒。

`read -n 1 -p "请输入性别" gender`带上`-n 字符数`就会在用户输入1个字符后自定执行程序下一步（无需回车）。比如你可以输入1或者0（假设1代表男性，0代表女性）。

## 环境变量配置文件

环境变量配置文件的作用就是用来放置想要永久生效的环境变量的，在每次开机后都能生效。如果我们想要永久型的更改环境变量，就绕不开配置环境变量配置文件。
写入环境变量配置文件的内容必须重新登录系统，里头的配置文件才会生效。如果想要立即生效可以使用`source  配置文件`的方式，让更改的内容立即生效。当然我们还可以缩写`. 配置文件`

![环境变量配置文件读取流程](https://raw.githubusercontent.com/jaylenchan/learning-summary/main/pic/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%B5%81%E7%A8%8B.png)
